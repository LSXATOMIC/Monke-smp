/** @Preserve
*	jQuery Mapz v1.0
*
*	by Danny van Kooten - http://dannyvankooten.com
*	Last Modification: 20/06/2011
*
*	For more information, visit:
*	http://dannyvankooten.com/jquery-plugins/mapz/
*
*	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
*		- Free for use in both personal and commercial projects
*		- Attribution requires leaving author name, author link, and the license info intact.	
*/
!function(e){e.fn.mapz=function(t){function i(){var t=a.children("map"),i=1,n=0;h.children(".level").each(function(){if(n++,!e(this).hasClass("current-level")){i=e(this).width()/h.width();var o=e(document.createElement("map")).attr("name",h.attr("id")+"-map-"+n);t.children("area").each(function(){var t=e(this).clone(),n=e(this).attr("coords").split(",");for(c in n)n[c]=Math.ceil(n[c]*i);t.attr("coords",n).appendTo(o)}),o.appendTo(a),e(this).attr("usemap","#"+h.attr("id")+"-map-"+n)}})}function n(){s.css({left:-h.width()+a.width(),top:-h.height()+a.height(),width:2*h.width()-a.width(),height:2*h.height()-a.height()}),h.position().left<s.position().left&&h.css("left",s.position().left),h.position().top<s.position().top&&h.css("top",s.position().top)}function o(e){var t=h.children(".current-level");switch(e){case"in":if(0==h.children(".current-level").next().length)return;var i=t.next();break;case"out":if(0==h.children(".current-level").prev().length)return;var i=t.prev()}i.addClass("current-level"),t.removeClass("current-level");var o=(h.position(),a.width()/2),r=a.height()/2,s=-h.position().left,c=-h.position().top,l=i.width()/t.width()*(s+o)-o,d=i.height()/t.height()*(c+r)-r;0>l&&(l=0),0>d&&(d=0),h.css({left:-l,top:-d,width:i.width(),height:i.height()}),n()}var r={zoom:!1,createmaps:!1,mousewheel:!1,pinchzoom:!1};t&&e.extend(r,t);var a=this.parent(".map-viewport"),h=this,s=e(document.createElement("div")).addClass("mapz-constraint").css("position","absolute").appendTo(a);if(h.children(".level:first").addClass("current-level"),n(),r.zoom){if(e(document).keydown(function(e){return 38==e.keyCode?(o("in"),!1):40==e.keyCode?(o("out"),!1):void 0}),r.mousewheel&&h.bind("mousewheel",function(e,t){var i=t>0?"in":"out";return o(i),!1}),r.pinchzoom)if("function"==typeof Hammer){var l=.12,d=0;this.hammer().on("pinchin",function(e){e.gesture.scale+d<1-l&&(d+=l,o("out"))}),this.hammer().on("pinchout",function(e){e.gesture.scale+d>1+l&&(d-=l,o("in"))}),this.hammer().on("release",function(){d=0})}else alert("pinchzoom cannot be turned on without hammer library");r.createmaps&&i()}h.draggable({containment:s})}}(jQuery);