/** @Preserve
*	jQuery Mapz v1.0
*
*	by Danny van Kooten - http://dannyvankooten.com
*	Last Modification: 20/06/2011
*
*	For more information, visit:
*	http://dannyvankooten.com/jquery-plugins/mapz/
*
*	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
*		- Free for use in both personal and commercial projects
*		- Attribution requires leaving author name, author link, and the license info intact.	
*/
!function(e){e.fn.mapz=function(t){function i(){var t=a.children("map"),i=1,n=0;s.children(".level").each(function(){if(n++,!e(this).hasClass("current-level")){i=e(this).width()/s.width();var o=e(document.createElement("map")).attr("name",s.attr("id")+"-map-"+n);t.children("area").each(function(){var t=e(this).clone(),n=e(this).attr("coords").split(",");for(c in n)n[c]=Math.ceil(n[c]*i);t.attr("coords",n).appendTo(o)}),o.appendTo(a),e(this).attr("usemap","#"+s.attr("id")+"-map-"+n)}})}function n(){l.css({left:-s.width()+a.width(),top:-s.height()+a.height(),width:2*s.width()-a.width(),height:2*s.height()-a.height()}),s.position().left<l.position().left&&s.css("left",l.position().left),s.position().top<l.position().top&&s.css("top",l.position().top),l.width()<=s.width()&&l.height()<=s.height()?s.css("cursor","default"):s.css("cursor","all-scroll")}function o(e){var t=s.children(".current-level");switch(e){case"in":if(0==s.children(".current-level").next().length)return;var i=t.next();break;case"out":if(0==s.children(".current-level").prev().length)return;var i=t.prev()}i.addClass("current-level"),t.removeClass("current-level"),r(i,t)}function r(e,t){var i=(s.position(),a.width()/2),o=a.height()/2,r=-s.position().left,h=-s.position().top,c=e.width()/t.width()*(r+i)-i,l=e.height()/t.height()*(h+o)-o;0>c&&(c=0),0>l&&(l=0),s.css({left:-c,top:-l,width:e.width(),height:e.height()}),n()}var h={zoom:!1,createmaps:!1,mousewheel:!1,pinchzoom:!1};t&&e.extend(h,t);var a=this.parent(".map-viewport"),s=this,l=e(document.createElement("div")).addClass("mapz-constraint").css("position","absolute").appendTo(a);s.children(".level:first").addClass("current-level");var d=s.children(".current-level");if(r(d,d),h.zoom){if(e(document).keydown(function(e){return 38==e.keyCode?(o("in"),!1):40==e.keyCode?(o("out"),!1):void 0}),h.mousewheel&&s.bind("mousewheel",function(e,t){var i=t>0?"in":"out";return o(i),!1}),h.pinchzoom)if("function"==typeof Hammer){var u=.12,p=0;this.hammer().on("pinchin",function(e){e.gesture.scale+p<1-u&&(p+=u,o("out"))}),this.hammer().on("pinchout",function(e){e.gesture.scale+p>1+u&&(p-=u,o("in"))}),this.hammer().on("release",function(){p=0})}else alert("pinchzoom cannot be turned on without hammer library");h.createmaps&&i()}s.draggable({containment:l})}}(jQuery);