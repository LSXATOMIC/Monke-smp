/**** @Preserve
 v1.7

 Copyright 2014 Glenn Fisher

 This is an unofficial mapping system for Minecraft. It is neither produced nor 
 endorsed by Mojang.

 Licenced under GPL licence, version 3 or later
 https://www.gnu.org/copyleft/gpl.html

 Note that other files in this project have their own licence, see \licence.md
*****/
function isEmpty(e){return!e||0===e.length}function isString(e){return"string"==typeof e||e instanceof String}function isNotEmptyString(e){return("string"==typeof e||e instanceof String)&&e.length>0}function isFunction(e){return"function"==typeof e}function stringToBool(e){switch(trim(e).toLowerCase()){case"true":case"on":case"yes":case"1":return!0;case"false":case"off":case"no":case"0":case null:return!1;default:return Boolean(string)}}function imageToCanvas(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}function trimRight(e){return isFunction(e.trimRight)?e.trimRight():e.replace(/\s+$/,"")}function trimLeft(e){return isFunction(e.trimLeft)?e.trimLeft():e.replace(/^\s+/,"")}function trim(e){return isFunction(e.trim)?e.trim():e.replace(/^\s+|\s+$/g,"")}function parseURL(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,a={},n=t.search.replace(/^\?/,"").split("&"),i=n.length,r=0;i>r;r++)n[r]&&(e=n[r].split("="),a[e[0]]=e[1]);return a}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}}function isImageOk(e){return e.complete?"undefined"!=typeof e.naturalWidth&&0==e.naturalWidth?!1:!0:!1}function MapConfiguration(){}function SuppressableLabel(e,t){this.text=e,this.displayOverride=void 0===t?LabellingStyleOverride.normal:t,this.suppress=this.displayOverride==LabellingStyleOverride.suppress,this.always=this.displayOverride==LabellingStyleOverride.always}function Location(e,t,a,n,i,r,o){this.x=e,this.z=t,this.type=a,this.labelOverride=SuppressableLabel.parse(n),this.hrefOverride=r,this.iconIndexOverride=o,this.owner=SuppressableLabel.parse(i)}function Rectangle(e,t,a,n){this.x1=Math.min(e,a),this.y1=Math.min(t,n),this.x2=Math.max(e,a),this.y2=Math.max(t,n),this.width=1+a-e,this.height=1+n-t}function SetDefaultSrc(e){isString(e)?gMapDataUriDefault=e:alert("SetDefaultSrc() was passed a non-string value")}function createLocationFromRow(e,t){var a,n=null;try{CSV.DETECT_TYPES=!1,CSV.TRIM_UNQUOTED_VALUES=!0,CSV.EXPAND_QUOTED_NEWLINES=!0,a=CSV.parse(t)[0]}catch(i){alert("Could not parse comma seperated values for entry/line "+e.toString()+": "+i)}var r=a[0];if("?"==r[r.length-1]&&(r=r.substring(0,r.length-1)),r in LocationType){var o=LocationType[r],s=parseInt(a[1]),h=parseInt(a[2]),l=parseInt(a[6]);isNaN(s)||isNaN(h)||(n=new Location(s,h,o,unquoteString(a[3]),unquoteString(a[4]),unquoteString(a[5]),l))}return n}function unquoteString(e){var t=e;if(isString(e)&&e.length>=2&&'"'==e[0]&&'"'==e[e.length-1]){var a=jQuery.parseJSON('{"value":'+e+"}");t=a.value}return t}function parseTextLocations(e,t){var a=new MapConfiguration,n=[],i=e.split("\n"),r=0;for(r=0;r<i.length;r++){var o=i[r];if("/"!=o[0]){var s=createLocationFromRow(r+1,i[r]);s instanceof Location?n.push(s):a.AssignFromRow(i[r])}}t(a,n)}function parseHtmlLocations(e,t){function a(e){var t=e,a=trim(e),n=a.length>=2&&'"'==a[0]&&'"'==a[a.length-1];return n||(a.indexOf(",")>=0||a.indexOf('"')>=0)&&(t='"'+a.replace(/"/g,'""')+'"'),t}var n=new MapConfiguration,i=[],r=jQuery.parseHTML(e),o=0;$(r).find("tr").each(function(){var e="";o++,$(this).find("td").each(function(){e+=a(this.textContent)+","});var t=createLocationFromRow(o,e);t instanceof Location?i.push(t):n.AssignFromRow(e)}),o=0,$(r).find("ul, ol").each(function(){$(this).find("li").each(function(){o++;var e=createLocationFromRow(o,this.textContent);e instanceof Location?i.push(e):n.AssignFromRow(this.textContent)})}),t(n,i)}function createMapImageInDiv(e,t,a,n,i,r,o){var s=document.createElement("canvas");s.width=a,s.height=n;var h;h=e<i.HideLabelsAbove?LabellingStyle.none:e>=i.ShowLabelsBelow?LabellingStyle.all:LabellingStyle.smart,drawMapDetails(s,i,r,h);var l=CreateAreaMapInDiv(t,a,n,i,r),c=$(document.createElement("img")).css("display","block")[0],g=$.Deferred();c.onload=function(){g.resolve()},c.src=s.toDataURL("image/png"),c.useMap="#"+l;var d=document.getElementById(t);$(c).appendTo(d),$.when(g).done(o)}function CreateAreaMapInDiv(e,t,a,n,i){var r=e+"-areamap",o=t>a?t:a,s=n.GetXTranslationFunction(o),h=n.GetZTranslationFunction(o),l=document.createElement("map");l.name=r;var c;for(c=0;c<i.length;++c){var g=i[c],d=g.getHref(),m=!1,p=document.createElement("area");isEmpty(d)||(p.href=d,m=!0);var u=generateHtmlLabel(g,n.ShowCoordinates&&!n.DisableCoordinates);u.length>0&&($(p).mouseover(CreateHandler_mouseover(u)),$(p).mouseout(Handle_mouseout),m=!0),m&&(p.shape="circle",p.coords=[s(g.x),h(g.z),cClickRadius],p.alt=g.getAlt(),$(p).appendTo(l))}return $(l).appendTo(document.getElementById(e)),r}function CreateHandler_mouseover(e){return function(){$("#locationDesc").empty(),$("#locationDesc").append(e),$("#hoverFrame").removeClass("hidden-hoverFrame")}}function Handle_mouseout(){$("#hoverFrame").addClass("hidden-hoverFrame"),$("#locationDesc").empty()}function generateHtmlLabel(e,t){var a="",n=e.getLabel();isNotEmptyString(n)&&(n=strToHtml(trim(n)));var i=e.owner.text;isNotEmptyString(i)&&(i=strToHtml(trim(i)));var r=isNotEmptyString(i)?n.indexOf(i):-1,o='<span class="locationHoverOwner">'+i+"</span>",s=!0;if(isNotEmptyString(n)&&n!=i){var h=n;r>=0&&(h=n.substring(0,r)+o+n.substring(r+i.length),s=!1),h='<span class="locationHoverPlacename">'+h+"</span>",a=h,isNotEmptyString(i)&&s&&(a+="<br/>")}return isNotEmptyString(i)&&s&&(a+=o),isNotEmptyString(a)&&t&&(a+='<span class="locationHoverCoordinates"><br/>'+e.x+", "+e.z+"</span>"),isNotEmptyString(a)&&isNotEmptyString(e.getHref(!0))&&(a+='<div style="height: 11px"><img src="img/link.png" height="7" style="vertical-align: middle"></div>'),a}function strToHtml(e){return e.replace("\n"," ").replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function drawMapDetails(e,t,a,n){function i(e){return e.split(/\r\n|\n|\r/)}function r(e,t,a){var n;"BoundsAtOrigin"in e?n=e.BoundsAtOrigin:(n=o(0,a,t,1),e.BoundsAtOrigin=n);var i,r=[];for(i=0;i<n.length;i++)r[i]=n[i].copy(w(e.x),v(e.z));return r}function o(e,t,a,n){var r=[];if(0>n||n>0||(n=0),!isEmpty(a)){var o,s=1,h=i(a);for(o=0;o<h.length;o++){var l=p.measureText(h[o]).width,c=p.measureText(trimLeft(h[o])).width,g=p.measureText(trimRight(h[o])).width,d=l-c,u=l-g,f=e-(l-1)/2,w=t+s;r[o]=new Rectangle(f+d-n,w-m-n,f+(l-1)-u+n,w+n),s+=m}}return r}function s(e,t,a){var n=0;if(!isEmpty(a)){var r,o=i(a);for(r=0;r<o.length;r++)p.fillText(o[r],e-p.measureText(o[r]).width/2,t+n),n+=m}}function h(e,t,a){var n=[];if(isNaN(e)||0>e);else{var i=IconBoundsInformation[e];void 0===i&&(i={width:20,height:20,yOffset:0});var r=t-i.width/2,o=a+i.yOffset-i.height/2;n[0]=new Rectangle(r,o,r+i.width-1,o+i.height-1)}return n}function l(e,t,a,n){!isNaN(e)&&e>=0&&(e>=cCustomIconIndexStart?gCustomIconsLoaded&&drawGlyph(p,gCustomIcons,e-cCustomIconIndexStart,t,a,n):drawGlyph(p,f,e,t,a,n))}function c(e,t){var a="",i=w(e.x),o=v(e.z);if(isEmpty(e.labelOverride.text)||e.labelOverride.suppress?isEmpty(e.owner.text)||e.owner.suppress||(a+=e.owner.text):a+=e.labelOverride.text,isEmpty(e.owner.text)||-1!=a.indexOf(e.owner.text)||e.owner.suppress||(a+="\n("+e.owner.text+")"),!isEmpty(a)&&t==O.Captions&&n!=LabellingStyle.none){var c=e.getIconIndex(),g=cTextOffset;(isNaN(c)||0>c)&&(g=3);var d=!0,m=e.labelOverride.always||e.owner.always;if(n==LabellingStyle.smart){var u,f=r(e,a,g);for(u=0;u<f.length;u++){var S,C=f[u];for(S=0;S<y.length;S++)if(C.intersects(y[S])){var I=h(e.getIconIndex(),i,o,0);if(0==I.length||!I[0].equals(y[S])){d=!1;break}}if(!d)break}(d||m)&&(y=y.concat(f))}if((d||m)&&s(i,o+g,a),cShowBoundingBoxes){p.lineWidth=1,p.strokeStyle="#0000FF";var S,x=r(e,a);for(S=0;S<x.length;S++)x[S].stroke(p)}}t==O.Masks&&l(e.getIconIndex(),!0,i,o),isEmpty(a)?t==O.UncaptionedIcons&&l(e.getIconIndex(),!1,i,o):t==O.CaptionedIcons&&l(e.getIconIndex(),!1,i,o)}function g(){var e=8,t=Math.round(w(0)),a=Math.round(v(0));p.lineWidth=2,p.strokeStyle="#6e5830",p.moveTo(t,a-e),p.lineTo(t,a+e),p.moveTo(t-e,a),p.lineTo(t+e,a),p.stroke()}function d(){var a=$("#map-background").width(),n=2*t.MapRange/a,i=Math.round(n).toString(),r=e.width/a,o=5,h=Math.round(6*r),l=Math.round(($("#map-background").height()-6)*r),c=Math.round(.4*r);p.lineWidth=2,p.strokeStyle="#6e5830",p.moveTo(h,l),p.lineTo(h+Math.round(r*o),l),p.lineTo(h+Math.round(r*o),l+c),p.moveTo(h,l-c),p.lineTo(h,l+c),p.moveTo(h+Math.round(r),l-c),p.lineTo(h+Math.round(r),l),p.stroke();var g=l-c-4,d=l+c+cTextOffset-4;s(h+r,g,i),s(h,d,"0"),s(h+r*o,d,Math.round(n*o).toString())}var m=10,p=e.getContext("2d"),u=e.width>e.height?e.width:e.height,f=document.getElementById("map-tileset"),w=t.GetXTranslationFunction(u),v=t.GetZTranslationFunction(u),y=[],O={Masks:0,Origin:1,Captions:2,UncaptionedIcons:3,CaptionedIcons:4,Scale:5,First:0,Last:5},S=document.getElementById("map-background");setCanvasScalingToPixelated(p),p.drawImage(S,0,0,e.width,e.height),p.lineWidth=1,p.strokeStyle="#FF00FF";var C;for(C=0;C<a.length;C++){var I=a[C],x=h(I.getIconIndex(),w(I.x),v(I.z),0);x.length>0&&(y[y.length]=x[0],cShowBoundingBoxes&&x[0].stroke(p))}p.font="10px Arial",p.font="10px 'Merienda', Arial, sans-serif";var b;for(b=O.First;b<=O.Last;b++)if(b==O.Origin)t.ShowOrigin&&g();else if(b==O.Scale)t.ShowScale&&d();else if(b==O.Captions){var M;for(M=0;M<a.length;M++)c(a[M],b)}else{var M;for(M=a.length-1;M>=0;M--)c(a[M],b)}}function setCanvasScalingToPixelated(e){e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1}function PreRender(e){if(null!=gOceanMapImage){var t=document.getElementById("map-background"),a=renderOcean(e,t,gOceanMapImage);t.src=a.toDataURL("image/png")}}function drawGlyph(e,t,a,n,i,r){var o=t.height/2,s=o/2;e.drawImage(t,a*o,n?o:0,o,o,i-s,r-s,o,o)}function renderOcean(e,t,a){if(0==a.width)return alert("Invalid ocean mask - width 0"),imageToCanvas(t);var n=a.width/2,i=a.height/2,r=Math.round(2*e.MapRange/cOceanBlocksPerPixel),o=Math.round(n+(e.X-e.MapRange)/cOceanBlocksPerPixel),s=Math.round(i+(e.Z-e.MapRange)/cOceanBlocksPerPixel),h=0>o?0:o,l=0>s?0:s,c=r-(h-o),g=r-(l-s);c=c>a.width?a.width:c,g=g>a.height?a.height:g;var d=t.width/r,m=Math.round((h-o)*d),p=Math.round((l-s)*d),u=Math.round(c*d),f=Math.round(g*d),w=u*cWorkingCanvasOversample,v=f*cWorkingCanvasOversample,y=document.createElement("canvas");y.width=w,y.height=v,workingContext=y.getContext("2d"),workingContext.drawImage(a,h,l,c,g,0,0,w,v);var O=e.OceanTheme.toLowerCase();return"darkseas"==O?renderTheme_DarkSeas(e,t,y,m,p,u,f):"coastalrelief"==O?renderTheme_CoastalRelief(e,t,y,m,p,u,f):renderTheme_BlueCoastline(e,t,y,m,p,u,f)}function renderTheme_BlueCoastline(e,t,a,n,i,r,o){var s=new RGB(127,130,146),h=new RGB(0,30,30),l=new RGB(243,226,194),c=new RGB(208,177,120),g=Math.round(204),d=Math.round(153),m=Math.round(51),p=CreateWorkingCanvas(e,a,r,o),u=p.getContext("2d"),f=p.width,w=p.height,v=a,y=Math.round(cWorkingCanvasOversample*t.width/8),O=3200/e.MapRange;O>3&&(O=3),y*=O,stackBlurCanvasRGB(v,0,0,v.width,v.height,y);var S,C=v.getContext("2d").getImageData(0,0,v.width,v.height).data,I=u.getImageData(0,0,f,w),x=I.data,b=new Array(256),M=new Array(256),T=new Array(256);for(S=0;S<b.length;S++){var L=S/255,B=s.Blend(l,L),R=.5/O;.5>R?R=.5:R>.7&&(R=.7),R>=L&&(B=B.Blend(h,.5-.5*L/R)),b[S]=B.R,M[S]=B.G,T[S]=B.B}var D=c.R,E=c.G,k=c.B,U=4*v.width/f,F=4*v.width*(v.height/w-1),N=0,A=0,H=0,G=0;for(A=0;w>A;A++){for(N=0;f>N;N++){blurPixel=C[G];var $,_=x[H]>128&&blurPixel>75;if(_)$=m,x[H]=D,x[H+1]=E,x[H+2]=k;else{var P=(255-blurPixel)/255;$=Math.round(g*(1-P)+d*P);var W=Math.round(.7*(255-blurPixel));W>255&&(W=255),0>W&&(W=0),x[H]=b[W],x[H+1]=M[W],x[H+2]=T[W]}x[H+3]=$,H+=4,G+=U}G+=F}u.putImageData(I,0,0);var q=cloneCanvas(t),z=q.getContext("2d");return z.drawImage(p,0,0,f,w,n,i,r,o),ApplyMapEdgesToCanvas(q,t,1,1)}function renderTheme_DarkSeas(e,t,a,n,i,r,o){var s=new RGB(144,104,67),h=new RGB(249,232,206),l=Math.round(178.5),c=Math.round(51),g=Math.round(63.75),d=CreateWorkingCanvas(e,a,r,o),m=d.getContext("2d"),p=d.width,u=d.height,f=a,w=Math.round(cWorkingCanvasOversample*t.width/8),v=3200/e.MapRange;v>3&&(v=3),w*=v,stackBlurCanvasRGB(f,0,0,f.width,f.height,w);var y=f.getContext("2d").getImageData(0,0,f.width,f.height).data,O=m.getImageData(0,0,p,u),S=O.data,C=h.R,I=h.G,x=h.B,b=s.R,M=s.G,T=s.B,L=4*f.width/p,B=4*f.width*(f.height/u-1),R=0,D=0,E=0,k=0;for(D=0;u>D;D++){for(R=0;p>R;R++){blurPixel=y[k];var U,F=S[E]>128&&blurPixel>75;F?(U=g,S[E]=C,S[E+1]=I,S[E+2]=x):(U=Math.round(blurPixel*(l-c)/255)+c,S[E]=b,S[E+1]=M,S[E+2]=T),S[E+3]=U,E+=4,k+=L}k+=B}m.putImageData(O,0,0);var N=cloneCanvas(t),A=N.getContext("2d");return A.drawImage(d,0,0,p,u,n,i,r,o),ApplyMapEdgesToCanvas(N,t,1,1)}function renderTheme_CoastalRelief(e,t,a,n,i,r,o){var s=new RGB(144,104,67),h=s.Blend(cColor_Black,.45),l=CreateWorkingCanvas(e,a,r,o),c=l.getContext("2d"),g=l.width,d=l.height,m=a,p=Math.round(cWorkingCanvasOversample*t.width/20);stackBlurCanvasRGB(m,0,0,m.width,m.height,p);var u=m.getContext("2d").getImageData(0,0,m.width,m.height).data,f=c.getImageData(0,0,g,d),w=f.data,v=h.R,y=h.G,O=h.B,S=4*m.width/g,C=4*m.width*(m.height/d-1),I=0,x=0,b=0,M=0;for(x=0;d>x;x++){for(I=0;g>I;I++){var T=255-w[b],L=u[M];w[b]=v,w[b+1]=y,w[b+2]=O,w[b+3]=L>T?T:L,b+=4,M+=S}M+=C}c.putImageData(f,0,0);var B=cloneCanvas(t),R=B.getContext("2d");return R.drawImage(l,0,0,g,d,n,i,r,o),ApplyMapEdgesToCanvas(B,t,1,0)}function CreateWorkingCanvas(e,t,a,n){(t.width%a!=0||t.height%n!=0||t.width/a!=cWorkingCanvasOversample)&&alert("CreateWorkingCanvas called with transformedOceanMask_Canvas size not a multiple of output size");var i=document.createElement("canvas");if(e.HardCoastlines){i.width=a,i.height=n;var r=i.getContext("2d");r.drawImage(t,0,0,t.width,t.height,0,0,a,n)}else i=cloneCanvas(t);return i}function ApplyMapEdgesToCanvas(e,t,a,n,i){void 0===a&&(a=2),void 0===n&&(n=4),void 0===i&&(i=0);var r=cloneCanvas(t),o=r.getContext("2d"),s=o.getImageData(0,0,r.width,r.height),h=s.data,l=e.getContext("2d"),c=l.getImageData(0,0,e.width,e.height),g=c.data,d=new Array(r.width),m=0;for(m=0;m<d.length;m++)d[m]=255;for(m=0;a>m;m++)d[m]=i,d[d.length-(m+1)]=i;for(m=0;n>m;m++){var p=i+Math.round((255-i)*(m+1)/(n+1));d[m+a]=p,d[d.length-(m+1+a)]=p}var u,f,w,v=0,y=0,O=0,S=!1;for(y=0;y<r.height;y++){var C=d[y];for(v=0;v<r.width;v++){if(0==h[O+3])g[O+3]=0;else if(S)if(h[O]==u&&h[O+1]==f&&h[O+2]==w)g[O+3]=0;else{var I=d[v],x=C>I?I:C;g[O+3]=x}else S=!0,u=h[O],f=h[O+1],w=h[O+2],g[O+3]=0;O+=4}}return l.putImageData(c,0,0),o.drawImage(e,0,0),r}function RGB(e,t,a,n){this.R=e,this.G=t,this.B=a,this.A=void 0===n?255:n}function cloneCanvas(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var a=t.getContext("2d");return a.drawImage(e,0,0),t}function createMapsInDivs_Async(e,t,a,n){function i(n,i){return function(){createMapImageInDiv(n,a[n].divName,a[n].width,a[n].height,e,t,function(){i.resolve()})}}PreRender(e);var r,o=[];for(r=0;r<a.length;r++){var s=$.Deferred();setTimeout(i(r,s),1),o[r]=s}$.when.apply($,o).done(n)}function getSettingsAndMapLocations(e,t,a){function n(e){document.title=e.Title,$("#mainTitle").text(e.Title),$("#tagline").text(e.Blurb)}function i(e,t){if(isString(e)){var a=new RegExp(".txt$|.csv$","i"),n=a.test(e);$.ajax({url:e,dataType:n?"text":"html",success:function(e,a,i){var r=i.getResponseHeader("content-type")||"";r.indexOf("text/plain")>=0||r.indexOf("text/csv")>=0||n?parseTextLocations(e,t):parseHtmlLocations(e,t)},error:function(t,a,n){alert(e==gMapDataUriDefault?'no "src=" url was specified to scrape the location data from.\n\n(and could not load from the fallback url)':'Failed to load locations from src "'+e+'", something went wrong: '+a+", "+n)}})}else alert("Internal error: dataUrl not string")}function r(e,t){var a=$.Deferred();return isEmpty(e.OceanMapUri)?t?(gOceanMapImage=document.getElementById("oceanmask"),null!=gOceanMapImage?isImageOk(gOceanMapImage)?a.resolve():(gOceanMapImage=null,a=null):a=null):a=null:(gOceanMapImage=new Image,$(gOceanMapImage).bind({load:function(){a.resolve()},error:function(){gOceanMapImage=null,a.resolve(),alert('Could not load oceam-map image at "'+e.OceanMapUri+'"')}}),gOceanMapImage.src=e.OceanMapUri),a}var o=new MapConfiguration;o.AssignFromUrl(location);var s=r(o,!1),h="MapDataUri"in o?o.MapDataUri:gMapDataUriDefault;isNotEmptyString(h)?i(h,function(i,h){var l=new MapConfiguration;l.SetDefaults(e,t),l.AssignFrom(i),l.AssignFrom(o),n(l);var c=[],g=$.Deferred();c[0]=g,isEmpty(l.CustomIconsUri)?g.resolve():($(gCustomIcons).bind({load:function(){gCustomIconsLoaded=!0,g.resolve()},error:function(){g.resolve()}}),gCustomIcons.src=l.CustomIconsUri),null==s&&(s=r(l,!0)),null!=s&&(c[1]=s),$.when.apply($,c).done(function(){a(l,h)})}):1!=o.Abort&&alert('no "src=" url was specified to scrape the location data from.')}var cMapRangeDefault=3200,cClickRadius=12,cTextOffset=14,cLabel_DontDrawChar="~",cLabel_AlwaysDrawChar="!",cCustomIconIndexStart=64,cShowBoundingBoxes=!1,gMapDataUriDefault="",gCustomIcons=new Image,gCustomIconsLoaded=!1,gOceanMapImage=null,LocationType={Village:{iconIndex:0,name:"Plains Village",href:"http://minecraft.gamepedia.com/Village#Plains"},DesertVillage:{iconIndex:1,name:"Desert village",href:"http://minecraft.gamepedia.com/Village#Desert"},SavannahVillage:{iconIndex:0,name:"Savannah village",href:"http://minecraft.gamepedia.com/Village#Savannah"},WitchHut:{iconIndex:3,name:"Witch's hut",href:"http://minecraft.gamepedia.com/Generated_structures#Witch_Huts"},JungleTemple:{iconIndex:4,name:"Jungle temple",href:"http://minecraft.gamepedia.com/Jungle_temple"},DesertTemple:{iconIndex:5,name:"Desert temple",href:"http://minecraft.gamepedia.com/Desert_temple"},NetherFortress:{iconIndex:6,name:"Nether Fortress",href:"http://minecraft.gamepedia.com/Nether_Fortress"},NetherPortal:{iconIndex:7,name:"Portal",href:"http://minecraft.gamepedia.com/Nether_Portal"},Forest:{iconIndex:28,name:"Forest",href:"http://minecraft.gamepedia.com/Biome#Forest"},FlowerForest:{iconIndex:26,name:"Flower forest",href:"http://minecraft.gamepedia.com/Flower_forest"},MushroomIsland:{iconIndex:29,name:"Mushroom island",href:"http://minecraft.gamepedia.com/Mushroom_Island"},Horse:{iconIndex:34,name:"",href:"http://minecraft.gamepedia.com/Horse"},Wolf:{iconIndex:35,name:"",href:"http://minecraft.gamepedia.com/Wolf"},Dragon:{iconIndex:36,name:"",href:""},SeaMonster:{iconIndex:45,name:"",href:""},Ship:{iconIndex:38,name:"",href:""},Spawn:{iconIndex:40,name:"Spawn",href:""},PlayerStructure:{iconIndex:8,name:"",href:""},PlayerCastle:{iconIndex:9,name:"",href:""},PlayerHouse:{iconIndex:10,name:"",href:""},PlayerFarm:{iconIndex:14,name:"Farm",href:""},PlayerMachine:{iconIndex:12,name:"",href:""},EnchantingRoom:{iconIndex:44,name:"",href:"http://minecraft.gamepedia.com/Enchantment_Table"},Label:{iconIndex:-1,name:"",href:""},FenceOverlay:{iconIndex:13,name:"",href:""},IslandOverlay:{iconIndex:30,name:"",href:""}},LabellingStyle={none:0,smart:1,all:2},LabellingStyleOverride={normal:0,suppress:1,always:2},IconBoundsInformation={0:{width:14,height:16,yOffset:-1},1:{width:14,height:16,yOffset:-1},2:{width:12,height:20,yOffset:0},3:{width:14,height:20,yOffset:-5},4:{width:16,height:17,yOffset:-2},5:{width:10,height:17,yOffset:0},6:{width:10,height:14,yOffset:-2},7:{width:10,height:13,yOffset:-1},8:{width:10,height:10,yOffset:0},9:{width:10,height:14,yOffset:-2},10:{width:12,height:11,yOffset:-1},11:{width:15,height:8,yOffset:0},12:{width:10,height:16,yOffset:-4},13:{width:0,height:0,yOffset:-8},14:{width:16,height:16,yOffset:-1},15:{width:12,height:13,yOffset:0},16:{width:10,height:10,yOffset:0},17:{width:10,height:10,yOffset:0},18:{width:10,height:10,yOffset:0},19:{width:12,height:12,yOffset:0},20:{width:16,height:16,yOffset:0},21:{width:4,height:18,yOffset:0},22:{width:14,height:24,yOffset:-4},23:{width:15,height:16,yOffset:-1},24:{width:15,height:16,yOffset:-1},25:{width:15,height:16,yOffset:-1},26:{width:14,height:14,yOffset:-1},27:{width:20,height:18,yOffset:-3},28:{width:24,height:22,yOffset:-4},29:{width:17,height:16,yOffset:-2},30:{width:0,height:0,yOffset:-8},31:{width:30,height:18,yOffset:0},32:{width:30,height:20,yOffset:-1},33:{width:18,height:16,yOffset:-1},34:{width:18,height:17,yOffset:0},35:{width:17,height:13,yOffset:0},36:{width:30,height:28,yOffset:1},37:{width:27,height:27,yOffset:1},38:{width:29,height:30,yOffset:0},39:{width:20,height:27,yOffset:-2},40:{width:14,height:12,yOffset:0},41:{width:18,height:16,yOffset:0},42:{width:14,height:22,yOffset:-4},43:{width:14,height:16,yOffset:-1},44:{width:14,height:16,yOffset:-1},45:{width:28,height:16,yOffset:1}};MapConfiguration.prototype.SetDefaults=function(){var e=0;"HideLabelsAbove"in this||(this.HideLabelsAbove=e),"ShowLabelsBelow"in this||(this.ShowLabelsBelow=3),"MapRange"in this||(this.MapRange=cMapRangeDefault),"Title"in this||(this.Title="Map of the Overworld"),"Blurb"in this||(this.Blurb="Use up/down or mousewheel to zoom, drag to scroll"),"CustomIconsUri"in this||(this.CustomIconsUri=""),"X"in this||(this.X=0),"Z"in this||(this.Z=0),"ShowOrigin"in this||(this.ShowOrigin=!0),"ShowScale"in this||(this.ShowScale=!0),"ShowCoordinates"in this||(this.ShowCoordinates=!1),"DisableCoordinates"in this||(this.DisableCoordinates=!1),"OceanTheme"in this||(this.OceanTheme="BlueCoastline"),"HardCoastlines"in this||(this.HardCoastlines=!1),"OceanMapUri"in this||(this.OceanMapUri="")},MapConfiguration.prototype.AssignFrom=function(e){"MapDataUri"in e&&(this.MapDataUri=e.MapDataUri),"HideLabelsAbove"in e&&(this.HideLabelsAbove=e.HideLabelsAbove),"ShowLabelsBelow"in e&&(this.ShowLabelsBelow=e.ShowLabelsBelow),"MapRange"in e&&(this.MapRange=e.MapRange),"Title"in e&&(this.Title=e.Title),"Blurb"in e&&(this.Blurb=e.Blurb),"CustomIconsUri"in e&&(this.CustomIconsUri=e.CustomIconsUri),"X"in e&&(this.X=e.X),"Z"in e&&(this.Z=e.Z),"ShowOrigin"in e&&(this.ShowOrigin=e.ShowOrigin),"ShowScale"in e&&(this.ShowScale=e.ShowScale),"ShowCoordinates"in e&&(this.ShowCoordinates=e.ShowCoordinates),"DisableCoordinates"in e&&(this.DisableCoordinates=e.DisableCoordinates),"OceanTheme"in e&&(this.OceanTheme=e.OceanTheme),"HardCoastlines"in e&&(this.HardCoastlines=e.HardCoastlines),"OceanMapUri"in e&&(this.OceanMapUri=e.OceanMapUri)},MapConfiguration.prototype.AssignFromRow=function(e){var t=e.indexOf("=");if(t>0){var a=trim(e.substring(0,t)).toLowerCase(),n=trim(e.slice(t+1));if("z"==a){var i=parseInt(n);isNaN(i)||(this.Z=i)}else if("x"==a){var r=parseInt(n);isNaN(r)||(this.X=r)}else if("hidelabelsabove"==a){var o=parseInt(n);isNaN(o)||(this.HideLabelsAbove=o)}else if("showlabelsbelow"==a){var s=parseInt(n);isNaN(s)||(this.ShowLabelsBelow=s)}else if("range"==a){var h=parseInt(n);isNaN(h)||(this.MapRange=h)}else"title"==a&&isString(n)?this.Title=unquoteString(n):"blurb"==a&&isString(n)?this.Blurb=unquoteString(n):"icons"==a&&isString(n)?this.CustomIconsUri=unquoteString(n):"googleicons"==a&&isString(n)?this.CustomIconsUri="https://googledrive.com/host/"+unquoteString(n):"showorigin"==a&&isString(n)?this.ShowOrigin=stringToBool(n):"showscale"==a&&isString(n)?this.ShowScale=stringToBool(n):"showcoordinates"==a&&isString(n)?this.ShowCoordinates=stringToBool(n):"disablecoordinates"==a&&isString(n)?this.DisableCoordinates=stringToBool(n):"oceantheme"==a&&isString(n)?(this.OceanTheme=unquoteString(n),this.HardCoastlines=this.OceanTheme.lastIndexOf("hard")==this.OceanTheme.length-4&&this.OceanTheme.length>3,this.HardCoastlines&&(this.OceanTheme=this.OceanTheme.substr(0,this.OceanTheme.length-4))):"oceansrc"==a&&isString(n)?this.OceanMapUri=unquoteString(n):"oceangooglesrc"==a&&isString(n)&&(this.OceanMapUri="https://googledrive.com/host/"+unquoteString(n))}},MapConfiguration.prototype.AssignFromUrl=function(e){var t=parseURL(e);if(void 0!==Object.keys&&0==Object.keys(t.params).length&&location.host.indexOf("googledrive.com")>20&&(alert('no "src=" url was specified to scrape the location data from.\n\n(On the off-chance you did specify a src parameter and it\'s gone, then Google Drive could be experiencing problems again:\nSee http://buildingwithblocks.info/googlebug for more details)'),this.Abort=!0),"hidelabelsabove"in t.params&&(this.HideLabelsAbove=t.params.hidelabelsabove),"showlabelsbelow"in t.params&&(this.ShowLabelsBelow=t.params.showlabelsbelow),"range"in t.params&&(this.MapRange=t.params.range),"title"in t.params&&isString(t.params.title)&&(this.Title=decodeURIComponent(t.params.title.replace(/\+/g," "))),"blurb"in t.params&&isString(t.params.blurb)&&(this.Blurb=decodeURIComponent(t.params.blurb.replace(/\+/g," "))),"x"in t.params){var a=parseInt(t.params.x);isNaN(a)||(this.X=a)}if("z"in t.params){var n=parseInt(t.params.z);isNaN(n)||(this.Z=n)}"hideorigin"in t.params&&(this.ShowOrigin=!1),"hidescale"in t.params&&(this.ShowScale=!1),"showorigin"in t.params&&isString(t.params.showorigin)&&(this.ShowOrigin=stringToBool(t.params.showorigin)),"showscale"in t.params&&isString(t.params.showscale)&&(this.ShowScale=stringToBool(t.params.showscale)),"showcoordinates"in t.params&&isString(t.params.showcoordinates)&&(this.ShowCoordinates=stringToBool(t.params.showcoordinates)),"icons"in t.params&&isString(t.params.icons)&&(this.CustomIconsUri=t.params.icons),"googleicons"in t.params&&isString(t.params.googleicons)&&(this.CustomIconsUri="https://googledrive.com/host/"+t.params.googleicons),"src"in t.params&&isString(t.params.src)&&(this.MapDataUri=decodeURIComponent(t.params.src)),"googlesrc"in t.params&&isString(t.params.googlesrc)&&(this.MapDataUri=0==t.params.googlesrc.toLowerCase().indexOf("http")?t.params.googlesrc:"https://googledrive.com/host/"+t.params.googlesrc),"oceansrc"in t.params&&isString(t.params.oceansrc)&&(this.OceanMapUri=t.params.oceansrc),"oceangooglesrc"in t.params&&isString(t.params.oceangooglesrc)&&(this.OceanMapUri=0==t.params.oceangooglesrc.toLowerCase().indexOf("http")?t.params.oceangooglesrc:"https://googledrive.com/host/"+t.params.oceangooglesrc),"oceantheme"in t.params&&isString(t.params.oceantheme)&&(this.OceanTheme=t.params.oceantheme,this.HardCoastlines=this.OceanTheme.lastIndexOf("hard")==this.OceanTheme.length-4&&this.OceanTheme.length>3,this.HardCoastlines&&(this.OceanTheme=this.OceanTheme.substr(0,this.OceanTheme.length-4)))},MapConfiguration.prototype.GetXTranslationFunction=function(e){var t=e/2,a=this.X,n=this.MapRange;return function(e){return(e-a)*t/n+t}},MapConfiguration.prototype.GetZTranslationFunction=function(e){var t=e/2,a=this.Z,n=this.MapRange;return function(e){return(e-a)*t/n+t}},SuppressableLabel.prototype.toString=function(){return this.text},SuppressableLabel.parse=function(e){var t=new SuppressableLabel(e);if(isString(e)){var a=trim(e);a.length>=2&&(a[0]==cLabel_DontDrawChar&&a[a.length-1]==cLabel_DontDrawChar?t=new SuppressableLabel(a.substring(1,a.length-1),LabellingStyleOverride.suppress):a[0]==cLabel_AlwaysDrawChar&&a[a.length-1]==cLabel_AlwaysDrawChar&&(t=new SuppressableLabel(a.substring(1,a.length-1),LabellingStyleOverride.always)))}return t},Location.prototype.getHref=function(e){return"-"==this.hrefOverride?"":isEmpty(this.hrefOverride)&&1!=e?this.type.href:this.hrefOverride},Location.prototype.getLabel=function(){return isEmpty(this.labelOverride.text)?this.type.name:this.labelOverride.text},Location.prototype.getIconIndex=function(){return isNaN(this.iconIndexOverride)||this.iconIndexOverride<0?this.type.iconIndex:this.iconIndexOverride},Location.prototype.getAlt=function(){var e=this.getLabel();return isEmpty(e)&&!isEmpty(this.owner.text)&&(e=this.owner.text),e},Rectangle.prototype.stroke=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=0),e.strokeRect(this.x1+t,this.y1+a,this.width,this.height)},Rectangle.prototype.copy=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),new Rectangle(this.x1+e,this.y1+t,this.x2+e,this.y2+t)},Rectangle.prototype.intersects=function(e){return this.x2>e.x1&&this.x1<e.x2&&this.y2>e.y1&&this.y1<e.y2},Rectangle.prototype.equals=function(e){return this.x1==e.x1&&this.y1==e.y1&&this.x2==e.x2&&this.y2==e.y2};var cOceanBlocksPerPixel=16,cWorkingCanvasOversample=4,cColor_Black=new RGB(0,0,0),cColor_White=new RGB(255,255,255);RGB.prototype.Blend=function(e,t){t=0>t?0:t>1?1:t;var a=1-t;return new RGB(Math.round(e.R*t+this.R*a),Math.round(e.G*t+this.G*a),Math.round(e.B*t+this.B*a))},RGB.prototype.MatchesRGB=function(e,t,a){return e==this.R&&t==this.G&&a==this.B},RGB.prototype.Matches=function(e){return e instanceof RGB&&e.R==this.R&&e.G==this.G&&e.B==this.B};